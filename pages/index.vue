<template>
  <div class="content">
    <h1 hidden>MissionDay é«˜å²¡ ç‰¹è¨­ã‚µã‚¤ãƒˆ</h1>
    <div id="top" class="bg-back">
      <img src="~/assets/img/logo2.svg" id="logo2" />
      <h2 class="subtitle">åŒ—é™¸åˆã¨ãªã‚‹MissionDayãŒå¯Œå±±çœŒé«˜å²¡å¸‚ã§é–‹å‚¬ï¼</h2>
      <h3 id="counter">
        çµ‚äº†ã—ã¾ã—ãŸã€‚
        <br />
        <u>684å</u>ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çš†ã•ã‚“ã«ã”å‚åŠ ã„ãŸã ãã¾ã—ãŸã€‚
        <br />ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚
      </h3><br/>
       <a style="color:white;font-weight:500;"
              href="https://docs.google.com/forms/d/e/1FAIpQLSfIAJy9jtnAZSwYf8IJ6sBq0TA-mNgTFAo9lvE_3rIaisJJNA/viewform"
              target="_blank"
              rel="noreferrer noopener"
            >å‚åŠ ã—ã¦ãã ã•ã£ãŸæ–¹ã¯<u>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</u>ã«ã”å”åŠ›ãŠé¡˜ã„ã—ã¾ã™ã€‚</a>
    </div>
    <div class="f-area">
      <ul class="horizon-list">

        <li class="h-item">
          <d-card>
            <n-link to="/volunteers">
              <d-card-body class="floating">
                <p>
                  MissionDay TAKAOKA ã¯å¤šãã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®
                  <br />å”åŠ›ã«ã‚ˆã£ã¦å®Ÿç¾ã—ã¾ã—ãŸğŸ‰
                  <br />ã“ã¡ã‚‰ã‚ˆã‚Šã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåã®ä¸€è¦§ã‚’é–²è¦§ã§ãã¾ã™ã€‚
                </p>
              </d-card-body>
            </n-link>
          </d-card>
        </li>

         <li class="h-item">
          <d-card>
            <a
              href="https://docs.google.com/forms/d/e/1FAIpQLSfIAJy9jtnAZSwYf8IJ6sBq0TA-mNgTFAo9lvE_3rIaisJJNA/viewform"
              target="_blank"
              rel="noreferrer noopener"
            >
              <d-card-body class="floating">
                <img src="~/assets/img/forms.png" style="width:40px;" />
                <b>MDã«é–¢ã™ã‚‹ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</b>
                <p>å‚åŠ ã—ã¦ãã ã•ã£ãŸAGã®æ–¹ã¯ã”å”åŠ›ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>
              </d-card-body>
            </a>
          </d-card>
        </li>

        <li class="h-item">
          <d-card>
            <a
              href="https://photos.app.goo.gl/QXryWp6oUE1yT4Ro9"
              target="_blank"
              rel="noreferrer noopener"
            >
              <d-card-body class="floating">
                <img src="~/assets/img/g-photos.png" style="width:40px;" />
                <b>GooglePhotoså…±æœ‰ã‚¢ãƒ«ãƒãƒ </b>
                <p>èª°ã§ã‚‚å†™çœŸã®é–²è¦§ãƒ»è¿½åŠ ãŒã§ãã¾ã™ã€‚</p>
              </d-card-body>
            </a>
          </d-card>
        </li>
        <li class="h-item">
          <d-card>
            <a
              href="https://twitter.com/search?q=%23mdtakaoka%20OR%20%23MD%E9%AB%98%E5%B2%A1&src=typed_query&f=live"
              target="_blank"
              rel="noreferrer noopener"
            >
              <d-card-body class="floating">
                <img src="~/assets/img/twitter-icon.png" style="width:40px;" />
                <b>æœ€æ–°æƒ…å ±ã¯Twitterã§</b>
                <p>ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã¯ #mdtakaoka #MDé«˜å²¡</p>
              </d-card-body>
            </a>
          </d-card>
        </li>
        <li class="h-item">
          <d-card>
            <n-link to="/qrpass">
              <d-card-body class="floating">
                <img src="~/assets/img/ticket-icon.png" style="width:40px;" />
                <b>QR-PASSã®ç™ºè¡Œã¯ã“ã¡ã‚‰</b>
                <p>
                  MDé«˜å²¡é™å®šã®
                  <u>ç‰¹å…¸</u>ãŒè²°ãˆã¾ã™ã€‚
                </p>
              </d-card-body>
            </n-link>
          </d-card>
        </li>
      </ul>
    </div>

    <div v-for="item in posts" :key="item.sys.id" class="f-area">
      <div class="f-content center">
        <img :src="item.fields.cover.fields.file.url+'?fm=jpg&q=80'" class="f-img" />
      </div>
      <div class="f-content">
        <h2 class="center title">{{item.fields.title}}</h2>
        <div v-html="item.fields.content" class="post"></div>
      </div>
    </div>
    <div id="daibutsu">
      <img src="~/assets/img/daibutsu.jpg" />
    </div>
    <div class="info">
      <h4>æœ€æ–°æƒ…å ±ã‚’æ›´æ–°ä¸­âš¡</h4>
      <p>
        ã“ã®ã‚µã‚¤ãƒˆã§ã¯ãƒŸãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã‚„è¦³å…‰ã‚¹ãƒãƒƒãƒˆãªã©ã‚’æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚
        <br />ã¾ãŸã€Twitterã‚„Telegramã‚’é€šã˜ã¦æœ€æ–°æƒ…å ±ã‚’ãŠå±Šã‘ã—ã¦ã„ã¾ã™ï¼ãœã²ã”æ´»ç”¨ãã ã•ã„ã€‚
      </p>
      <div class="info-btn">
        <a
          href="https://twitter.com/mdtakaoka"
          class="navBotton active"
          target="_blank"
          rel="noreferrer noopener"
        >Twitterã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</a>
        <a
          href="https://t.me/joinchat/AAAAAFQj7GWHVx469bwPLA"
          class="navBotton active"
          target="_blank"
          rel="noreferrer noopener"
        >Telegramãƒãƒ£ãƒãƒ«</a>
      </div>
      <br />
      <p>SNSã§ã¯ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’ã”åˆ©ç”¨ãã ã•ã„ï¼</p>
      <div class="hasharea">
        <a
          href="https://twitter.com/search?q=%23mdtakaoka+%23MD%E9%AB%98%E5%B2%A1"
          target="_blank"
          rel="noreferrer noopener"
        >
          <h2 class="hashtag bg-back">
            #MDé«˜å²¡&nbsp;
            #mdtakaoka
          </h2>
        </a>
      </div>
    </div>
  </div>
</template>

<script>
import moment from "moment";
import { createClient } from "~/plugins/contentful.js";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import { INLINES, BLOCKS } from "@contentful/rich-text-types";

const client = createClient();
const options = {
  renderNode: {
    [INLINES.HYPERLINK]: (node, next) =>
      `<a href=${
        node.data.uri
      } target="_blank" rel="noreferrer noopener">${next(node.content)}</a>`,
    [BLOCKS.EMBEDDED_ASSET]: node =>
      `<img src="${node.data.target.fields.file.url +
        "?fm=jpg&q=50"}" class="post-img"/>`
  }
};

export default {
  head() {
    return {
      __dangerouslyDisableSanitizers: ["script"],
      title: "",
      script: [
        {
          innerHTML: `{
  "@context": "https://schema.org",
  "@type": "Event",
  "name": "MissionDay é«˜å²¡",
  "startDate": "2019-09-21T10:00",
  "endDate": "2019-09-21T18:00",
  "location": {
    "@type": "Place",
    "name": "ã‚¦ã‚¤ãƒ³ã‚°ã‚¦ãƒ»ã‚¤ãƒ³ã‚°é«˜å²¡ åºƒå ´",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "ï¼‘",
      "addressLocality": "é«˜å²¡å¸‚æœ«åºƒç”º",
      "postalCode": "9330023",
      "addressRegion": "å¯Œå±±çœŒ",
      "addressCountry": "JP"
    }
  },
  "image": [
    "https://mdtakaoka.info/image1x1.jpg",
    "https://mdtakaoka.info/image4x3.jpg",
    "https://mdtakaoka.info/image16x9.jpg"
   ],
  "description": "åŒ—é™¸åˆï¼INGRESS MissionDayé«˜å²¡ã‚’2019å¹´9æœˆ21æ—¥(åœŸ) å¯Œå±±çœŒé«˜å²¡å¸‚ã«ã¦é–‹å‚¬è‡´ã—ã¾ã™ï¼"
}`,
          type: "application/ld+json"
        }
      ]
    };
  },
  computed: {
    days: function() {
      const eventDate = moment("2019-09-21 24:00");
      const today = moment();
      //console.log(moment().date(), eventDate.diff(today, "days"));
      return eventDate.diff(today, "days");
    }
  },
  async asyncData({ env }) {
    return Promise.all([
      // fetch all blog posts sorted by creation date
      client.getEntries({
        content_type: "top",
        order: "sys.createdAt"
      })
    ])
      .then(([posts]) => {
        // return data that should be available
        // in the template
        //console.log(posts.items[0].fields.content);
        posts.items.map(function(value) {
          value.fields.content = documentToHtmlString(
            value.fields.content,
            options
          );
        });
        //console.log(posts.items);
        return {
          posts: posts.items
        };
      })
      .catch(console.error);
  }
};
</script>

<style scoped>
#top {
  text-align: center;
  padding: 2em;
  margin: 0 !important;
}
#logo2 {
  width: 90%;
  max-width: 800px;
  margin-bottom: 2em;
}
.hasharea {
  display: flex;
  justify-content: center;
}
.hashtag {
  padding: 0.2em;
  font-weight: 700;
  font-size: 2em;
  border-radius: 0.2em;
}
.hashtag {
  color: white;
}
.subtitle {
  color: white;
  font-size: 1.5em;
  margin-bottom: 1.5em;
}
#about {
  padding: 1em;
  text-align: center;
  display: block;
}
#map {
  width: 100%;
  max-width: 600px;
}
.textbox {
  padding: 10px;
  text-align: left;
}
.f-area h2 {
  font-weight: bold;
  font-size: 2em;
  color: rgb(65, 65, 65);
}
.f-area {
  display: flex;
  flex-wrap: wrap;
  padding: 2em;
  justify-content: center;
  border-bottom: solid 1px #e9ecef;
}
.f-content {
  width: 550px;
  padding: 1em;
}
.f-img {
  width: 100%;
  max-width: 700px;
  height: auto;
}
.info h4 {
  font-weight: bold;
  padding: 1em;
}
.info {
  text-align: center;
  margin: 2em;
}
.info-btn {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
}
.info-btn a {
  text-decoration: none;
  color: white;
  font-weight: bold;
  padding: 0.8em;
  margin: 1em;
  width: 10em;
}

#daibutsu img {
  width: 100%;
  background-size: cover;
  background: linear-gradient(-45deg, #3fc35f, #64b3f4);
}
#counter {
  display: inline;
  padding: 5px;
  color: white;
  font-size: 1em;
}
#counter {
  /*border: solid white;
  animation: flash 2s ease infinite;
  font-size: 1.5em;*/
}
.navBotton {
  padding: 10px;
  color: gray;
  fill: gray;
}
.active {
  background-image: linear-gradient(45deg, #4facfe 0%, #3fc35f 100%);
  border-radius: 25px;
  fill: white;
  box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.4);
}
.title {
  background-image: linear-gradient(to right, #4facfe, #3fc35f);
  background-repeat: no-repeat;
  background-size: 100% 10%;
  background-position: bottom;
}
.floating {
  color: rgb(65, 65, 65);
}
.VueCarousel-slide {
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  border-right: 1px solid #fff;
  box-sizing: border-box;
  padding-bottom: 10px;
}
.VueCarousel {
  margin: 1em 2em 1em 2em;
}
@keyframes flash {
  50% {
    opacity: 0.6;
  }
}
.horizon-list {
  overflow-x: auto;
  white-space: nowrap;
  -webkit-overflow-scrolling: touch;
  padding: 0;
}
.h-item {
  /* æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨ */
  display: inline-block;
  width: auto;
}
.bottom-card {
  max-width: 400px;
}
.card-text {
  padding: 0 !important;
  margin: 0;
  text-align: initial;
}
@media (max-width: 1170px) {
  .VueCarousel {
    margin: 0;
  }
  .f-area {
    justify-content: center;
    padding: 0;
  }
  .f-content {
    width: 100%;
    height: 70%;
    padding: 0.5em;
    max-width: 90%;
  }
  .center {
    text-align: center;
  }
  .horizon-list {
    margin-left: -10px;
  }
}
</style>
